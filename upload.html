<!DOCTYPE html>
<html>
<head>
    <title>Subir Fotos al Evento</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 500px; margin: 0 auto; padding: 20px; }
        #preview { max-width: 100%; margin-top: 20px; display: none; }
        button { background: #4285F4; color: white; border: none; padding: 10px 20px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Sube tu foto al evento</h1>
    <input type="file" id="foto" accept="image/*">
    <button onclick="subirFoto()">Subir Foto</button>
    <img id="preview">
    <p id="mensaje"></p>

    <script>
        async function subirFoto() {
            const file = document.getElementById('foto').files[0];
            if (!file) {
                alert("¡Selecciona una foto primero!");
                return;
            }

            const mensaje = document.getElementById('mensaje');
            mensaje.textContent = "Subiendo...";
            
            // Convertir la foto a base64
            const reader = new FileReader();
            reader.onload = async function(e) {
                const base64Data = e.target.result.split(',')[1];
                
                try {
                    // Usamos un servicio intermedio (no requiere backend propio)
                    const response = await fetch("https://script.google.com/macros/s/AKfycbzX7JbkWXHkU6JZ7JZ7JZ7JZ7JZ7JZ7JZ7JZ7JZ7JZ7JZ7JZ7JZ7JZ7/exec", {
                        method: "POST",
                        body: JSON.stringify({
                            nombre: `foto_${Date.now()}.jpg`,
                            datos: base64Data
                        })
                    });
                    
                    const result = await response.json();
                    if (result.exito) {
                        mensaje.textContent = "¡Foto subida con éxito!";
                        document.getElementById('preview').src = `https://drive.google.com/thumbnail?id=${result.id}&sz=w500`;
                        document.getElementById('preview').style.display = "block";
                    } else {
                        mensaje.textContent = "Error: " + result.error;
                    }
                } catch (error) {
                    mensaje.textContent = "Error al subir: " + error.message;
                }
            };
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>
